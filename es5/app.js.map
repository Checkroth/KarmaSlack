{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["import { install as sourceMapSupportInstall } from 'source-map-support';\r\nimport Express from 'express';\r\nimport BodyParser from 'body-parser';\r\nimport Slack from 'slack-node';\r\n\r\nimport Config from '../es5/config.js'; \r\nimport KarmaMongoose from '../es5/karmamongoose.js';\r\nimport KarmaModel from '../es5/karma.model.js'; \r\n\r\nsourceMapSupportInstall();\r\n\r\nvar app = Express();\r\napp.use(BodyParser.urlencoded({ extended: true }));\r\n\r\nvar config = new Config();\r\n\r\nvar karmaMongoose = new KarmaMongoose(config);\r\nkarmaMongoose.init();\r\n\r\n\r\n\r\nvar add = function(teamId, userName){\r\n\t\r\n\treturn KarmaModel.create({\r\n\t\t\"teamId\": teamId,\r\n\t\t\"userName\": userName,\r\n\t})\r\n\t.then(() => {\r\n\t\t\r\n\t\treturn userCount(teamId, userName, \"increased\");\r\n\t});\r\n};\r\n\r\nvar remove = function(teamId, userName){\r\n\t\r\n\treturn KarmaModel.deleteLatestPoint(teamId, userName)\t\r\n\t.then(() => {\r\n\t\t\r\n\t\treturn userCount(teamId, userName, \"decreased\");\r\n\t});\r\n};\r\n\r\nvar userCount = function(teamId, userName, incDec){\r\n  \r\n\treturn KarmaModel.points(teamId, userName)\r\n\t.then((collection) => {\r\n\t\tvar response = `${userName} has a karma of ${collection.length}!`; \t\t \r\n\r\n\t\tif(incDec){\r\n\t\t\tresponse = `${userName}s karma has ${incDec} to ${collection.length}!`;\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log(response);\r\n\t});\r\n};\r\n\r\nadd(\"111\", \"DAN\").then(function(){\r\n\r\n\tremove(\"111\", \"DAN\").then(function(){\r\n\r\n\t\tuserCount(\"111\", \"DAN\");\r\n\t});\r\n});\r\n/*\r\nconsole.log(\"1\");\r\nadd(\"111\", \"DAN\")\r\n.then(()=>{\r\n\tconsole.log(\"3\");\r\n\tremove(\"111\", \"DAN\");\r\n})\r\n\r\n\r\nvar promise = new Promise((resolve,reject) => {\r\n\tadd(\"111\", \"DAN\").then(resolve(2));\r\n\tconsole.log(\"1\");\r\n\t//resolve(2);\r\n}).then((a)=>{\r\n\tconsole.log(a);\r\n\tremove(\"111\", \"DAN\");\r\n})*/\r\n\r\n\r\n\r\n\r\nvar teamCount = function(teamId, userName){\r\n\t\r\n};\r\n\r\n\r\n//app.post('/test2',  (req, res) => {\r\n\t\r\n\r\n\t\r\n\t\r\n\t//KarmaModel.find({}).remove().exec();\r\n\t\r\n\t//KarmaModel.find({}).exec(function(err, collection){\r\n     /*   var promise = KarmaModel.create({\r\n\t\t\t  \"teamId\":\"111\",\r\n\t          \"userName\":\"DAN\",\r\n\t        },{\r\n\t\t\t  \"teamId\":\"111\",\r\n\t          \"userName\":\"DAN\",\r\n\t        },{\r\n\t\t\t  \"teamId\":\"111\",\r\n\t          \"userName\":\"BRETT\",\r\n        });\t\r\n\t\t\r\n\t\tpromise.then((err, karmas) => {\r\n\t\t  \tKarmaModel.points(\"111\",\"BRETT\", function(err, collection){\r\n\t\t\t\t//console.log('eeee: ' + collection.length);\r\n\t\t\t});\r\n\t\t});*/\r\n\t\t\t\r\n\t//});\r\n\t\r\n\r\n\r\n\r\n\t //res.send('Hello World!');\r\n\t\r\n//});\r\n\r\napp.post('/test',  (req, res) => {\r\n\t\r\n\t\r\n\tvar channelName = req.body.channel_name;\r\n\tvar text = req.body.text;\r\n\tvar slackResponse = `Response: ${text}`;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t/*\r\n\t\r\n\tmongoose.connect(config.db);\r\n\t\r\n\tvar db = mongoose.connection;\r\n\t\r\n\tdb.on('error', console.error.bind(console, 'connection error...'));\r\n\tdb.once('open', function callback(){\r\n\t\tconsole.log('db opened');\r\n\t});\r\n\t\r\n\tContact.find({}).remove().exec();\r\n\t\r\n\tContact.find({}).exec(function(err, collection){\r\n\t        Contact.create({\r\n\t          \"name\":text,\r\n\t        });\t\r\n\t});\r\n\t\r\n\t*/\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t//Test valid text value\r\n\tvar karmaPattern = /((karma: <!)([a-z0-9]+)(> )(\\+\\+|\\-\\-))/g;\r\n\t\r\n\tif(!karmaPattern.test(text)){\r\n\t\tslackResponse = `Invalid: ${text} | Format Example: karma: @user ++`;\r\n\t}\r\n\t\r\n\t//var user = text.replace('karma:', '');\r\n\t\r\n\tvar slackRes = new Slack();\r\n\tslackRes.setWebhook(\"https://hooks.slack.com/services/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\");\r\n\t\r\n\tslackRes.webhook({\r\n\t  channel: \"#\" + channelName,\r\n\t  username: \"webhookbot\",\r\n\t  text: slackResponse + \"   |||||| \" + text\r\n\t}, (err, response) => {\r\n\t  console.log(response);\r\n\t});\r\n});\r\n//((karma: @)([a-z0-9]+ )(\\+\\+|\\-\\-))\r\napp.listen(config.port, \r\n\t() => console.log(`Running on port ${config.port}`));\r\n"],"sourceRoot":"D:\\Projects\\karma\\warm-sea-8289\\es6"}