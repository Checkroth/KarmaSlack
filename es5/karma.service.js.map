{"version":3,"sources":["karma.service.js"],"names":[],"mappings":"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","file":"karma.service.js","sourcesContent":["import KarmaModel from '../es5/karma.model.js'; \r\n\r\nexport default class KarmaService {\r\n\t\r\n\tconstructor() {\r\n\t\t\r\n\t}\r\n\t\r\n\t//Add Karma record\r\n\t\r\n\tadd(teamId, userName, fromUserName){\t\t\r\n\r\n\t\treturn new Promise((res,rej) =>{\r\n\t\t\t\r\n\t\t\tKarmaModel.create({\r\n\t\t\t\t\"teamId\": teamId,\r\n\t\t\t\t\"userName\": userName,\r\n\t\t\t\t\"fromUserName\": fromUserName\r\n\t\t\t})\r\n\t\t\t.then(() => {\t\t\r\n\t\t\t\treturn this.userCount(teamId, userName, \"increased\")\r\n\t\t\t\t\t\t.then((data) => res(data));\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\t//Remove Karma record\r\n\t\r\n\tremove(teamId, userName, fromUserName){\r\n\t\t\r\n\t\treturn new Promise((res,rej) =>{\r\n\t\t\t\r\n\t\t\tif(userName === fromUserName){\t\t\r\n\t\t\t\treturn fromSelf()\r\n\t\t\t\t\t\t.then((data)=> res(data));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn KarmaModel.deleteLatestPoint(teamId, userName, fromUserName)\t\r\n\t\t\t.then((entity) => {\r\n\t\t\t\tif(!entity){\r\n\t\t\t\t\treturn whenNoRecordFound(userName)\r\n\t\t\t\t\t\t\t.then((data)=> res(data));\r\n\t\t\t\t}\t\t\r\n\t\t\t\treturn this.userCount(teamId, userName, \"decreased\")\r\n\t\t\t\t\t\t.then((data) => res(data));\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tfunction whenNoRecordFound (userName){\r\n\t  \r\n\t\t\treturn Promise.resolve(`${userName} needs some positive karma from you first.`);\r\n\t\t};\r\n\t\t\r\n\t\tfunction fromSelf (){\r\n\t\t  \r\n\t\t\treturn Promise.resolve(`Don't be so hard on yourself.`);\r\n\t\t};\r\n\t}\r\n\t\r\n\t//Get Karma count for user\r\n\t\r\n\tuserCount(teamId, userName, incDec){\r\n  \r\n\t\treturn new Promise((res,rej) =>{\r\n\t\t\tKarmaModel.getUserPoints(teamId, userName)\r\n\t\t\t.then((collection) => {\r\n\t\t\t\tvar responseText = `${userName} has a karma of ${collection.length}.`; \t\t \r\n\t\t\r\n\t\t\t\tif(incDec){\r\n\t\t\t\t\tresponseText = `${userName}s karma has ${incDec} to ${collection.length}.`;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tres(responseText);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\t//Get Karma count for team\r\n\r\n\tteamCount(teamId){\r\n\t\t\r\n\t\treturn new Promise((res,rej) =>{\r\n\t\t\tKarmaModel.getTeamPoints(teamId)\r\n\t\t\t.then((collection) => {\r\n\t\t\t\t\r\n\t\t\t\tvar responseText = 'Karma Totals: \\n';\r\n\t\t\t\t\r\n\t\t\t\tfor (let user = 0, len = collection.length; user < len; user++) {\r\n\t\t\t\t\tlet element = collection[user];\r\n\t\t\t\t\tresponseText += ` ${element._id} has a karma of ${element.count}. \\n`;\r\n\t\t\t\t}\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tres(responseText);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}"],"sourceRoot":"D:\\Projects\\karma\\warm-sea-8289\\es6"}